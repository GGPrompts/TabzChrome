(function(){console.log("Terminal Tabs content script loaded");function m(){if(window.location.hostname!=="github.com")return null;const t=window.location.pathname.match(/^\/([^/]+)\/([^/]+)/);if(t){const[,e,n]=t,o=n.replace(/\.git$/,"");return{owner:e,repo:o,fullName:`${e}/${o}`}}return null}function u(){if(window.location.hostname!=="gitlab.com")return null;const t=window.location.pathname.match(/^\/([^/]+)\/([^/]+)/);if(t){const[,e,n]=t,o=n.replace(/\.git$/,"");return{owner:e,repo:o,fullName:`${e}/${o}`}}return null}function d(){const t=m(),e=u();t&&(console.log("GitHub repo detected:",t.fullName),document.addEventListener("contextmenu",n=>{chrome.runtime.sendMessage({type:"ADD_CONTEXT_MENU",items:[{id:"clone-github-repo",title:`Clone ${t.fullName}`,action:()=>{chrome.runtime.sendMessage({type:"SPAWN_TERMINAL",command:`git clone https://github.com/${t.fullName}.git`,cwd:"~/projects"})}}]})})),e&&(console.log("GitLab repo detected:",e.fullName),document.addEventListener("contextmenu",n=>{chrome.runtime.sendMessage({type:"ADD_CONTEXT_MENU",items:[{id:"clone-gitlab-repo",title:`Clone ${e.fullName}`,action:()=>{chrome.runtime.sendMessage({type:"SPAWN_TERMINAL",command:`git clone https://gitlab.com/${e.fullName}.git`,cwd:"~/projects"})}}]})}))}const p=[{pattern:/command not found: (.+)/,getSuggestion:t=>{const e=t[1];return`Install ${e} using: sudo apt install ${e} or brew install ${e}`}},{pattern:/npm ERR! (.+)/,getSuggestion:()=>"Try: npm install or npm cache clean --force"},{pattern:/yarn error (.+)/,getSuggestion:()=>"Try: yarn install or rm -rf node_modules && yarn"},{pattern:/Permission denied/,getSuggestion:()=>"Try running with sudo or check file permissions"},{pattern:/ENOENT: no such file or directory/,getSuggestion:t=>"File or directory not found - check the path"},{pattern:/Port \d+ is already in use/,getSuggestion:t=>{const e=t[0].match(/Port (\d+)/);if(e){const n=e[1];return`Port ${n} in use. Find process: lsof -ti:${n} | xargs kill -9`}return"Port already in use - kill the process using it"}}];function g(){const t=console.error;console.error=(...n)=>{t(...n);const o=n.map(i=>typeof i=="string"?i:JSON.stringify(i)).join(" ");for(const{pattern:i,getSuggestion:s}of p){const r=o.match(i);if(r){const l=s(r);chrome.runtime.sendMessage({type:"SHOW_ERROR_SUGGESTION",error:r[0],suggestion:l});break}}};const e=console.warn;console.warn=(...n)=>{e(...n)}}function a(){document.querySelectorAll("pre code, code").forEach(e=>{var i;const n=e.textContent||"",o=[/^npm install/m,/^npm run/m,/^yarn install/m,/^yarn add/m,/^pnpm install/m,/^pnpm add/m];for(const s of o)if(s.test(n)){if(!((i=e.parentElement)!=null&&i.querySelector(".terminal-tabs-run-btn"))){const r=document.createElement("button");r.className="terminal-tabs-run-btn",r.textContent="▶ Run in Terminal",r.style.cssText=`
            position: absolute;
            top: 4px;
            right: 4px;
            padding: 4px 8px;
            font-size: 12px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            z-index: 1000;
          `,r.onclick=()=>{chrome.runtime.sendMessage({type:"SPAWN_TERMINAL",command:n.trim()})},e.parentElement&&(e.parentElement.style.position="relative",e.parentElement.appendChild(r))}break}})}function f(){document.addEventListener("keydown",t=>{(t.metaKey||t.ctrlKey)&&t.key==="k"&&(t.preventDefault(),chrome.runtime.sendMessage({type:"OPEN_POPUP"}))})}function c(){d(),g(),a(),f(),new MutationObserver(()=>{a()}).observe(document.body,{childList:!0,subtree:!0}),console.log("✅ Terminal Tabs content script initialized")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",c):c();
})()
